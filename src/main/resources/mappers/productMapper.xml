<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.www.repository.ProductMapper">
    <insert id="insert">
        INSERT INTO product (name, price, discount_price, product_category_detail_id, description,
        total_qty, main_image, thumb_image, seller_id)
        VALUES
        (#{name}, #{price}, #{discountPrice}, #{productCategoryDetailId}, #{description},
        #{totalQty}, #{mainImage}, #{thumbImage}, #{sellerId}
        )
    </insert>

    <select id="getMyRegisteredProduct" resultType="com.project.www.domain.ProductVO">
        SELECT * FROM product
        WHERE
        seller_id = #{id}
    </select>

    <select id="getProductId" resultType="long">
        SELECT max(id) FROM product
    </select>
    <select id="getDetail" resultType="com.project.www.domain.ProductVO">
        SELECT * FROM product
        WHERE
        id = #{id}
    </select>
    
    <update id="productQtyUpdate">
        UPDATE product SET
        total_qty = #{totalQty}
        WHERE
        id = #{id}
    </update>

    <select id="getNewProductList" resultType="com.project.www.domain.ProductVO">
        SELECT * from product
        ORDER BY register_date DESC
        limit 0,4
    </select>

    <select id="getHeavySoldList" resultType="com.project.www.domain.ProductVO">
        SELECT * from product
        ORDER BY total_sold_qty DESC
        limit 0,4
    </select>

    <select id="getDiscountProductList" resultType="com.project.www.domain.ProductVO">
        SELECT * from product
        ORDER BY discount_rate DESC
        limit 0,4
    </select>

    <update id="orderUpdate">
        UPDATE product
        SET
        total_qty = total_qty - #{qty},
        total_sold_qty = total_sold_qty + #{qty}
        WHERE
        id = #{productId}
    </update>


</mapper>